name: Compile Source
on: push

jobs:
  compile:
    strategy:
      matrix:
        target: [x86_64-unknown-linux-gnu, x86_64-pc-windows-msvc, x86_64-apple-darwin, aarch64-apple-darwin]
    runs-on: ubuntu-20.04
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v2
      - name: Install Deno
        uses: denoland/setup-deno@v1
        with:
          deno-version: vx.x.x
      - name: Compile
        run: deno compile --allow-net --allow-read --allow-write --quiet --no-check --import-map=import_map.json --output DogAPI-${{ matrix.target }}
      - name: Upload Artifacts
        uses: actions/upload-artifact@v2
        with:
          name: Compiled (${{ matrix.target }})
          path: DogAPI-${{ matrix.target }}
    